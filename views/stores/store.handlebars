<main class="main" id="store-container">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="/public/css/store.css" />
  <link rel="stylesheet" href="/public/css/styles.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>const stores = [{{{ json store }}}];</script>

  <h1>{{store.name}}</h1>
  {{#if user}}
  {{#if (eq user.role "admin")}}
  <div class="admin-buttons">
    <button class="edit-store">Edit Store</button>
    <button class="save-changes">Save Changes</button>
    <button class="cancel-edit">Cancel</button>
    <button class="del-store">Delete Store</button>   
 </div>
  {{/if}}
  {{/if}}
  <div class="content-container">
    <div class="store-details-container">
        <div class="store-info">
       <h2>
          <span id="store-name">{{store.name}}</span>
        </h2>
        <p>
          <b>Address:</b>
          <span id="store-address">{{store.location.address}}</span>
        </p>
        <p>
          <b>Phone:</b>
          <span id="store-phone">{{store.phone}}</span>
        </p>

        {{#if errors}}
        <div id="error-messages">
          {{#each errors}}
          <div id="error-container" class="error-container">{{this}}</div>
          {{/each}}
        </div>
        {{/if}}
  
      {{#if (eq user.role "customer")}}
      <button class="place-service-request-button">Place a Service Request</button>
      {{/if}}
    </div>

      <div id="map-container">
        <div id="map"></div>
      </div>
    </div>
  </div>
  <div class="reviews-container">
    <h2>Customer Reviews</h2>
    <p><b>Average Rating:</b>
      {{#if totalRatings}}
      {{totalRatings}}/ 5
      {{else}}
      N/A
      {{/if}}
    </p>
    {{#if customerReviews}}
    <ul class="reviews-list">
      {{#each customerReviews}}
      <li>
        <p><b>{{customerName}}</b>: <i>{{comment}}</i></p>
        <p>Rating: {{rating}} / 5</p>
      </li>
      {{/each}}
    </ul>
    {{else}}
    <p>No reviews available for this store.</p>
    {{/if}}
  </div>
  <script src="/public/js/leaflet.js"></script>
  <script src="/public/js/form_validate.js"></script>
  <script src="/public/js/index.js"></script>
</main>